- name: install python packages
  apt:
      name: "{{ item }}"
      state: present
      update_cache: yes
  with_items:
    - cmake
    - build-essential
    - python-dev
    - python3-dev
    - python-pip
    - python3-pip
- name: check if miniconda directory exists
  stat: path="{{ home }}/miniconda2"
  register: miniconda

- name: download miniconda installation file
  get_url:
      url: http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh
      dest: /tmp/miniconda.sh
      owner: "{{ username }}"
      group: "{{ username }}"
      mode: 0755
  when: miniconda.stat.exists == False

- name: install miniconda
  shell: /tmp/miniconda.sh -b -p "{{ home }}/miniconda2/"
      executable=/bin/bash
  become: true
  become_user: "{{ username }}"
  when: miniconda.stat.exists == False

- name: install jupyter notebook
  command: conda install -y jupyter chdir="{{ home }}/miniconda2/bin/"
  environment:
      PATH: "{{ home }}/miniconda2/bin/:$PATH"

- name: install jupyter client for 2.7 (needed for vim-ipython)
  pip:
      name: jupyter_client
